<mxfile host="65bd71144e">
    <diagram id="VaeLvAhHS9jMmolEGU3U" name="Page-1">
        <mxGraphModel dx="449" dy="434" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="2" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="200" y="230" width="420" height="440" as="geometry"/>
                </mxCell>
                <mxCell id="3" value="segment" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="384" y="130" width="60" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="4" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="440" y="300" width="140" height="240" as="geometry"/>
                </mxCell>
                <mxCell id="5" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="230" y="300" width="160" height="240" as="geometry"/>
                </mxCell>
                <mxCell id="7" value="store" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="490" y="270" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="8" value="index" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="290" y="270" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="9" value="entry" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="250" y="330" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="10" value="entry" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="250" y="395" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="11" value="entry" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="250" y="460" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="12" value="" style="endArrow=classic;html=1;exitX=0.617;exitY=1.05;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" source="3" target="13" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="320" y="330" as="sourcePoint"/>
                        <mxPoint x="370" y="280" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="13" value="record" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="480" y="330" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="14" value="レコード作成" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="440" y="180" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="15" value="" style="endArrow=classic;html=1;exitX=0.533;exitY=1.05;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.713;entryY=-0.017;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="3" target="5" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="431.02" y="161" as="sourcePoint"/>
                        <mxPoint x="490" y="340" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="16" value="エントリを追加" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="280" y="180" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="19" value="&lt;h1&gt;書き込み時&lt;/h1&gt;&lt;p&gt;セグメントはデータをストアに書き込み、インデックスに新たなエントリを追加する&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="330" y="20" width="190" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="20" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="970" y="230" width="420" height="440" as="geometry"/>
                </mxCell>
                <mxCell id="21" value="segment" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="1154" y="130" width="60" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="22" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="1210" y="300" width="140" height="240" as="geometry"/>
                </mxCell>
                <mxCell id="23" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="1000" y="300" width="160" height="240" as="geometry"/>
                </mxCell>
                <mxCell id="24" value="store" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="1260" y="270" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="25" value="index" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="1060" y="270" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="26" value="entry" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="1020" y="330" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="27" value="entry" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="1020" y="395" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="28" value="entry" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="1020" y="460" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="29" value="" style="endArrow=classic;html=1;exitX=0.617;exitY=1.05;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" source="21" target="30" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1090" y="330" as="sourcePoint"/>
                        <mxPoint x="1140" y="280" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="30" value="record" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="1250" y="330" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="31" value="レコードを読み取り" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="1210" y="180" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="32" value="" style="endArrow=classic;html=1;exitX=0.533;exitY=1.05;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.713;entryY=-0.017;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="21" target="23" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1201.02" y="161" as="sourcePoint"/>
                        <mxPoint x="1260" y="340" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="33" value="エントリを検索" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="1050" y="180" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="34" value="&lt;h1&gt;読み取り時&lt;/h1&gt;&lt;p&gt;セグメントはインデックスからエントリを検索し、ストアからデータを取り出す&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="1100" y="20" width="190" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="35" value="" style="shape=flexArrow;endArrow=classic;html=1;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="414" y="700" as="sourcePoint"/>
                        <mxPoint x="414" y="770" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="36" value="具体的な実装内容" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="444" y="710" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="37" value="segment構造体&lt;br&gt;baseOffset: 16(固定)&lt;br&gt;nextOffset: 16(baseOffsetと同じ)" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="98.25" y="870" width="180" height="180" as="geometry"/>
                </mxCell>
                <mxCell id="38" value="store構造体&lt;br&gt;size: 0" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="568.25" y="896" width="160" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="40" value="index構造体&lt;br&gt;size: 0&lt;br&gt;mmap: 36 (entWidth * 3)" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="348.25" y="896" width="160" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="41" value="segment構造体作成時" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="340" y="790" width="146.5" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="42" value="offWidth = 4&lt;br&gt;posWidth = 8&lt;br&gt;entWidth = offWidth + posWidth" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="335.25" y="850" width="180" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="44" value="record構造体&lt;br&gt;value:&quot;hello world&quot;" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="193" y="1645" width="110" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="46" value="ログ追加(初回)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="370" y="1139" width="114" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="48" value="追加するrecord構造体&lt;br&gt;valueの値ではなく、構造体をそのままつっこむ" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="173" y="1765" width="150" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="49" value="segment構造体&lt;br&gt;baseOffset: 16(固定)&lt;br&gt;nextOffset: 17(処理終了後にnextOffset + 1)&lt;br&gt;&lt;br&gt;返り値&lt;br&gt;off = current nextOffset = 16&lt;br&gt;-&amp;gt; 次回取得時は+ 1" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="133" y="1335" width="190" height="190" as="geometry"/>
                </mxCell>
                <mxCell id="50" value="store構造体&lt;br&gt;size: 23&lt;br&gt;内部: 書き込まれるレコードのバイト数を8byte分確保した上で追加し実際のレコードを追加(15byte)" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="483" y="1535" width="160" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="52" value="引数&lt;br&gt;nextOffset(16) - baseOffset(16) = 0&lt;br&gt;pos(store.file.size = 0)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="333" y="1335" width="210" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="54" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="49" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="263" y="1605" as="sourcePoint"/>
                        <mxPoint x="473" y="1635" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="228" y="1635"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="55" value="" style="endArrow=classic;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.659;entryY=1.016;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="50" target="49" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="238" y="1545" as="sourcePoint"/>
                        <mxPoint x="393" y="1645" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="258" y="1615"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="56" value="pos = store.file.size = 0&lt;br&gt;(書き込む前のファイルサイズ)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="283" y="1575" width="170" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="57" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="49" target="58" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="238" y="1545" as="sourcePoint"/>
                        <mxPoint x="499.5" y="1360.7500000000005" as="targetPoint"/>
                        <Array as="points"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="58" value="&lt;span&gt;index構造体&lt;/span&gt;&lt;br&gt;&lt;span&gt;size: 12(12ごとに繰り上がる)&lt;/span&gt;&lt;br&gt;&lt;span&gt;(nextOffset(16) - baseOffset(16) =&amp;nbsp;&lt;/span&gt;&lt;span&gt;0を4byte確保し書き込む&lt;br&gt;&lt;/span&gt;&lt;span&gt;pos = 0を8byte確保し書き込む)&lt;/span&gt;&lt;br&gt;&lt;span&gt;mmap: 36 entWidth * 3&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="560" y="1339" width="280" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="59" value="①" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="193" y="1545" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="60" value="②" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="453" y="1595" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="61" value="③" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="333" y="1395" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="75" value="&lt;div&gt;結果&lt;/div&gt;&lt;div&gt;off 16&lt;/div&gt;&lt;div&gt;s.baseOffset 16&lt;/div&gt;&lt;div&gt;s.nextOffset 17&lt;/div&gt;&lt;div&gt;s.index.size 12&lt;/div&gt;&lt;div&gt;len(s.index.mmap) 36&lt;/div&gt;&lt;div&gt;s.store.size 23&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="365" y="1180" width="130" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="76" value="record構造体&lt;br&gt;value:&quot;hello world&quot;" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="180.5" y="2365" width="110" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="77" value="追加するrecord構造体&lt;br&gt;valueの値ではなく、構造体をそのままつっこむ" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="160.5" y="2485" width="150" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="78" value="segment構造体&lt;br&gt;baseOssset: 16(固定)&lt;br&gt;nextOffset: 18(処理終了後にnextOffset + 1)&lt;br&gt;&lt;br&gt;返り値&lt;br&gt;off = current nextOffset = 17&lt;br&gt;-&amp;gt; 次回取得時は+ 1" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="120.5" y="2057" width="190" height="190" as="geometry"/>
                </mxCell>
                <mxCell id="79" value="store構造体&lt;br&gt;size: 46&lt;br&gt;内部: 書き込まれるレコードのバイト数を8byte分確保した上で追加し実際のレコードを追加(15byte)" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="470.5" y="2255" width="160" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="80" value="引数&lt;br&gt;nextOffset(16) - baseOffset(17) = 1&lt;br&gt;pos(store.file.size = 23)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="320.5" y="2055" width="210" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="81" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="78" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="250.5" y="2325" as="sourcePoint"/>
                        <mxPoint x="460.5" y="2355" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="215.5" y="2355"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="82" value="" style="endArrow=classic;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.659;entryY=1.016;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="79" target="78" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="225.5" y="2265" as="sourcePoint"/>
                        <mxPoint x="380.5" y="2365" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="245.5" y="2335"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="83" value="pos = store.file.size = 23&lt;br&gt;(書き込む前のファイルサイズ)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="270.5" y="2295" width="170" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="84" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="78" target="85" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="225.5" y="2265" as="sourcePoint"/>
                        <mxPoint x="487" y="2080.7500000000005" as="targetPoint"/>
                        <Array as="points"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="85" value="&lt;span&gt;index構造体&lt;/span&gt;&lt;br&gt;&lt;span&gt;size: 24(12ごとに繰り上がる)&lt;/span&gt;&lt;br&gt;&lt;span&gt;(nextOffset(16) - baseOffset(17) = 1&lt;/span&gt;&lt;span&gt;を4byte確保し書き込む&lt;br&gt;&lt;/span&gt;&lt;span&gt;pos = 23を8byte確保し書き込む)&lt;/span&gt;&lt;br&gt;&lt;span&gt;mmap: 36 entWidth * 3&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="547.5" y="2059" width="280" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="86" value="①" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="180.5" y="2265" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="87" value="②" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="440.5" y="2315" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="88" value="③" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="320.5" y="2115" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="89" value="&lt;div&gt;結果&lt;/div&gt;&lt;div&gt;&lt;div&gt;off 17&lt;/div&gt;&lt;div&gt;s.baseOffset 16&lt;/div&gt;&lt;div&gt;s.nextOffset 18&lt;/div&gt;&lt;div&gt;s.index.size 24&lt;/div&gt;&lt;/div&gt;&lt;div&gt;len(s.index.mmap) 36&lt;/div&gt;&lt;div&gt;s.store.size 46&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="354.5" y="1930" width="130" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="90" value="ログ追加(2回目)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="360" y="1890" width="114" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="91" value="" style="shape=flexArrow;endArrow=classic;html=1;entryX=0.447;entryY=-0.015;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" target="46" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="421" y="1080" as="sourcePoint"/>
                        <mxPoint x="450" y="1420" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="93" value="" style="shape=flexArrow;endArrow=classic;html=1;entryX=0.447;entryY=-0.015;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="420.04" y="1830" as="sourcePoint"/>
                        <mxPoint x="419.9980000000001" y="1888.5499999999997" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="96" value="segment構造体&lt;br&gt;baseOffset: 16(固定)&lt;br&gt;nextOffset: 18&lt;br&gt;&lt;br&gt;返り値&lt;br&gt;off = current nextOffset = 17&lt;br&gt;-&amp;gt; 次回取得時は+ 1" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="920" y="2057" width="190" height="190" as="geometry"/>
                </mxCell>
                <mxCell id="97" value="store構造体&lt;br&gt;size: 46&lt;br&gt;posから8byte分取得し、読み取るレコードのbyte数を取得&lt;br&gt;そのbyte数で読み出し、デコードする" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
                    <mxGeometry x="1270" y="2255" width="160" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="98" value="cur = off = 17&lt;br&gt;(レコード追加時に返り値として取得した値)&lt;br&gt;off(17) - baseOffset(16) =&amp;nbsp; out = 1を引数で渡す" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="1130" y="2050" width="260" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="99" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="96" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1050" y="2325" as="sourcePoint"/>
                        <mxPoint x="1260" y="2355" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="1015" y="2355"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="100" value="" style="endArrow=classic;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.659;entryY=1.016;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="97" target="96" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1025" y="2265" as="sourcePoint"/>
                        <mxPoint x="1180" y="2365" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="1045" y="2335"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="102" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;" parent="1" source="96" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1025" y="2265" as="sourcePoint"/>
                        <mxPoint x="1400" y="2104" as="targetPoint"/>
                        <Array as="points"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="103" value="&lt;span&gt;index構造体&lt;/span&gt;&lt;br&gt;&lt;span&gt;size: 24(12ごとに繰り上がる)&lt;br&gt;&lt;/span&gt;&amp;nbsp;pos = uinit(out) * entWidth(12) = 12で読み取り&lt;br&gt;outは12 〜 16の範囲で1を取得(4byte固定)&lt;br&gt;posは16〜 24の範囲で23を取得(8byte固定)" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="1410" y="2050" width="280" height="161" as="geometry"/>
                </mxCell>
                <mxCell id="104" value="③" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="1010" y="2365" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="105" value="②" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="1360" y="2135" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="106" value="①" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="1110" y="2080" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="108" value="" style="shape=flexArrow;endArrow=classic;html=1;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1194.4199999999998" y="695.72" as="sourcePoint"/>
                        <mxPoint x="1194" y="2040" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="109" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1390" y="2127" as="sourcePoint"/>
                        <mxPoint x="1112" y="2127" as="targetPoint"/>
                        <Array as="points"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="112" value="pos = 23を返す" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="1200" y="2135" width="100" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="113" value="pos = 23を引数で渡す" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="1075" y="2365" width="130" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="114" value="④&amp;nbsp;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="1060" y="2305" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="115" value="読み出した結果を返す&lt;br&gt;&lt;span&gt;value:&quot;hello world&quot;&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="1095" y="2300" width="140" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="116" value="" style="shape=image;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;aspect=fixed;imageAspect=0;image=https://storage.googleapis.com/zenn-user-upload/ea5a1014815e463d9e643e6d.png;" parent="1" vertex="1">
                    <mxGeometry x="920" y="1240.73" width="540" height="304.27" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="6IuTHcorMyGQRcgi9W77" name="Page-2">
        <mxGraphModel dx="153" dy="87" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="ApotxhABHW0B6uMRuJWH-0"/>
                <mxCell id="ApotxhABHW0B6uMRuJWH-1" parent="ApotxhABHW0B6uMRuJWH-0"/>
                <mxCell id="ApotxhABHW0B6uMRuJWH-2" value="" style="shape=image;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;aspect=fixed;imageAspect=0;image=https://storage.googleapis.com/zenn-user-upload/ea5a1014815e463d9e643e6d.png;" parent="ApotxhABHW0B6uMRuJWH-1" vertex="1">
                    <mxGeometry x="920" y="1240.73" width="1205.53" height="679.27" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="-Yuxas4KLtgXRev6Q3kl" name="Page-3">
        <mxGraphModel dx="1276" dy="434" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="a6Zbn8eVY7nvMM-QkmC9-0"/>
                <mxCell id="a6Zbn8eVY7nvMM-QkmC9-1" parent="a6Zbn8eVY7nvMM-QkmC9-0"/>
                <mxCell id="a6Zbn8eVY7nvMM-QkmC9-4" value="storeの最大バイトを32にする" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-125" y="322" width="180" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="a6Zbn8eVY7nvMM-QkmC9-5" value="NewLogを実行する" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-65" y="382" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="a6Zbn8eVY7nvMM-QkmC9-6" value="storeのマックスバイトを1024にするが、すでに設定してあるのでしない&lt;br&gt;indexのマックスバイトを1024バイトに設定" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-225" y="472" width="400" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="a6Zbn8eVY7nvMM-QkmC9-7" value="l.setUp()を実行&lt;br&gt;ディレクトリ内のファイルを全て取得する&lt;br&gt;拡張子を除いて、ファイル名をuinit64に変換し、それをbaseOffsetとして配列に詰める&lt;br&gt;配列に詰めたuinit64をソートし、小→大で並べる&lt;br&gt;配列の要素数を最大としfor文で回し、newSegmentメソッドを実行する&lt;br&gt;&lt;div style=&quot;color: rgb(212 , 212 , 212) ; background-color: rgb(30 , 30 , 30) ; font-family: &amp;#34;menlo&amp;#34; , &amp;#34;monaco&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; line-height: 18px&quot;&gt; l.&lt;span style=&quot;color: #dcdcaa&quot;&gt;newSegment&lt;/span&gt;(baseOffsets[i]) // l.newSegment(0),&amp;nbsp;&lt;/div&gt;&lt;span style=&quot;color: rgb(212 , 212 , 212) ; font-family: &amp;#34;menlo&amp;#34; , &amp;#34;monaco&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; background-color: rgb(30 , 30 , 30)&quot;&gt;l.newSegment(2) 1飛ばし,&lt;br&gt;segmentがない場合は新たにセグメントを作成する&lt;br&gt;&lt;br&gt;&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-255" y="532" width="480" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="a6Zbn8eVY7nvMM-QkmC9-9" value="segment" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="490" y="190" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="a6Zbn8eVY7nvMM-QkmC9-10" value="log" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-65" y="202" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="H2MC7YfqRKFaAsnYkY9X-0" value="" style="endArrow=classic;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="245" y="818" as="sourcePoint"/>
                        <mxPoint x="345" y="818" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="H2MC7YfqRKFaAsnYkY9X-1" value="baseOffSetが0, 2, 4という1飛ばしで実行&lt;br&gt;結果をactiveSegmentにし、segments配列に詰める&lt;br&gt;複数segemntがある場合は何度もforが実行されることで、activeSegmentは塗り変わる" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-250" y="687" width="480" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="bFYJgTVllD8NjW84qetz-0" value="baseOffSet = 4を渡した場合" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="245" y="773" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="bFYJgTVllD8NjW84qetz-1" value="4.store, 4.indexファイルを開く" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="414" y="803" width="180" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="bFYJgTVllD8NjW84qetz-3" value="store" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="800" y="190" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="bFYJgTVllD8NjW84qetz-4" value="index" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="1010" y="190" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="bFYJgTVllD8NjW84qetz-5" value="" style="endArrow=classic;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="650" y="812.5" as="sourcePoint"/>
                        <mxPoint x="740" y="812.5" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="bFYJgTVllD8NjW84qetz-6" value="4.storeのファイルサイズを&lt;br&gt;構造体に格納" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="770" y="801" width="160" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="bFYJgTVllD8NjW84qetz-7" value="4.indexのファイルサイズを&lt;br&gt;構造体に格納し、予め設定&lt;br&gt;されたMax byteまで拡張する&lt;br&gt;ファイルの内容をメモリに置く(mmap)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="965" y="786" width="220" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="bFYJgTVllD8NjW84qetz-9" value="" style="endArrow=classic;html=1;startArrow=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" source="bFYJgTVllD8NjW84qetz-10" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="740" y="935.5" as="sourcePoint"/>
                        <mxPoint x="650" y="935.5" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="bFYJgTVllD8NjW84qetz-10" value="indexファイルの末尾を読み出し中身が何もない時、&lt;br&gt;nextOffSetをbaseOffsetにする&lt;br&gt;ある場合はセグメントの最後のオフセットをnextOffsetに設定する&lt;br&gt;ためbaseOffset + uinit64(0) +1を実行&lt;br&gt;baseOffset = 既存のセグメントの個数(indexにmax2回書き込み、6回書き込んでいたら&lt;br&gt;baseOffset = 3&lt;br&gt;uint64(0) = baseOffsetを除いて何回書き込んでいるか。&lt;br&gt;そしてその次が欲しいので+1する)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="235" y="876" width="480" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="sWEHb1eJT83oS5SMsiW2-0" value="" style="endArrow=none;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" target="bFYJgTVllD8NjW84qetz-10" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="740" y="935.5" as="sourcePoint"/>
                        <mxPoint x="650" y="935.5" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="sWEHb1eJT83oS5SMsiW2-1" value="NowLogが実行されたタイミングで&lt;br&gt;baseOffset = index 1ファイル全てに書き込んだ総量&lt;br&gt;nextOffset = 次に書き込むポジションになる&lt;br&gt;つまり、indexに2回書き込むことができ5回書き込んだ場合は&lt;br&gt;baseOffset = 4, nextOffset = 6となる&lt;br&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-190" y="760" width="350" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="sWEHb1eJT83oS5SMsiW2-2" value="logを追加する&lt;br&gt;(全セグメント数 -1)のnextOffset&lt;br&gt;を-1して返す。&lt;br&gt;現在のセグメントがアクティブな時、次に作成する&lt;br&gt;segemntは上の値を+1したものになる&lt;br&gt;例えば、7回目の書き込みの場合&lt;br&gt;セグメントはbaseOffsetが0,2,4で作成され、4つ目のセグメントのnextOffsetは7である。&lt;br&gt;なのでhighestOffsetは5となり、容量はいっぱいなので&lt;br&gt;次に作成するセグメントは5 + 1で6で作成する&lt;br&gt;新たに作成されたセグメントは次のアクティブセグメントとなる&lt;br&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-255" y="965" width="490" height="150" as="geometry"/>
                </mxCell>
                <mxCell id="gZPDgnhd0i4VMeqdRldM-2" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-185" y="1200" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="gZPDgnhd0i4VMeqdRldM-3" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-50" y="1200" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="gZPDgnhd0i4VMeqdRldM-4" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="80" y="1200" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="gZPDgnhd0i4VMeqdRldM-5" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-185" y="1280" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="gZPDgnhd0i4VMeqdRldM-6" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-125" y="1280" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="gZPDgnhd0i4VMeqdRldM-7" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="-50" y="1280" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="gZPDgnhd0i4VMeqdRldM-8" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="10" y="1280" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="gZPDgnhd0i4VMeqdRldM-9" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="80" y="1280" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="gZPDgnhd0i4VMeqdRldM-10" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="a6Zbn8eVY7nvMM-QkmC9-1" vertex="1">
                    <mxGeometry x="140" y="1280" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--0" value="ex segment&lt;br&gt;(baseOffset = 4&lt;br&gt;&amp;nbsp;4.segmentというファイルからbaseoffsetを取得)&lt;br&gt;4.indeの中身が何もなければ、nextOffset = baseOffset&lt;br&gt;あれば、position(1回目なら0、2回目なら1)&lt;br&gt;を足して&lt;br&gt;さらに+1したものがnextoffsetになる" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="290" y="1900" width="190" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--1" value="4.store&lt;br&gt;-&amp;gt; ファイルサイズを格納" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="90" y="1880" width="150" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--2" value="4.index&lt;br&gt;-&amp;gt; 中身を確認" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="90" y="1990" width="150" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--3" value="setUp" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="235" y="1700" width="50" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--4" value="書き込み" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="230" y="2130" width="60" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--5" value="Log構造体が保持する各セグメントからの最後のセグメントを取得し、そのnextOffsetを取得し-1する&lt;br&gt;現在のactiveSegmentがmaxの場合、新たにセグメントを作成することで、それが新たしいactiveSgmentに設定される" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="75" y="2170" width="195" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--7" value="書き込む内容をマーシャリングし、storeに書き込む&lt;br&gt;storeは書き込む前の、ファイルサイズを返す" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="316" y="2180" width="195" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--8" value="indexでは、nextOffset -&amp;nbsp; baseoffsetをエントリとし、storeから受け取ったファイルサイズを書き込む&lt;br&gt;-&amp;gt; エントリを指定するとstoreから内容を取得できる" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="310" y="2330" width="195" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--9" value="読み出し" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="250" y="2510" width="60" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--10" value="オフセットを引数で受け取り、log構造体が保持しているセグメントのbaseOffsetの中で該当のオフセットを含むセグメントをみつける&lt;br&gt;baseoffset = 0, 2, 4, 6&lt;br&gt;オフセット = 3&lt;br&gt;baseOffset = 2をもつセグメントが該当" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="67.5" y="2560" width="195" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--12" value="指定したオフセット(3)を引数にindexを読み出す&lt;br&gt;indexのReadメソッドの引数には&lt;br&gt;オフセット(3) - baseOffset(2) = 1&lt;br&gt;を指定し、storeのファイルサイズ(読み出し位置)を取得する&lt;br&gt;バイト列が返ってくるのでアンマーシャリングしレコード構造体に格納し返す" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="72.5" y="2730" width="195" height="130" as="geometry"/>
                </mxCell>
                <mxCell id="XmMbN-CJSVBsZEt9zfe--14" value="指定したディレクトリの中からファイルを取得し、拡張子を除きparseIntしたものをbaseOffsetとして扱う" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="a6Zbn8eVY7nvMM-QkmC9-1">
                    <mxGeometry x="180" y="1740" width="180" height="90" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>